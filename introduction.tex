\chapter{Introduction}\label{chap:introduction}

\lettrine[lines=3]{T}{he subject of study} of this thesis is Bose--Einstein condensation, as well as associated experimental and theoretical techniques and phenomena in cold atom physics. The following chapters describe my work in a cold atom research group over the past several years, pertaining to the design and modelling of new experimental techniques, the development of modelling methods for more effectively simulating cold-atom systems, and the design and development of laboratory software for control and analysis of experiments on cold atoms. An overarching theme is \emph{state-dependent forces} on cold atoms. Selectively subjecting atoms to forces based on what state they are in is at the core of many phenomena in cold atom physics. As I go into in the following chapters, different types of state selectivity allow for cooling and imaging techniques that would otherwise not be possible, and semiclassical models run into a problem when state-selective forces cannot be disregarded in determining the classical force that atoms modelled semiclassically ought to be subjected to.

% \section{Overview of thesis}

Bose--Einstein condensates (\textsc{bec}s) in dilute atomic gases are superfluids that can be created in the lab at extremely low temperatures. This strange state of matter was predicted in 1925 by Einstein~\cite{einstein_quantentheorie_1925} based on the work of Bose~\cite{bose_plancks_1924}, and first produced experimentally in 1995~\cite{anderson_observation_1995} in a cloud of rubidium atoms, and has since been made out of many other atoms, usually alkali metals~\cite{davis_bose-einstein_1995, modugno_bose-einstein_2001, bradley_bose-einstein_1997, weber_bose-einstein_2003}. In a \textsc{bec}, a macroscopic sample of bosonic atoms all occupy the same quantum state, and many of the features of the single particle wavefunctions are exhibited by the cloud as a whole. Bose--Einstein condensation and cold atoms and ions more generally have rich applications in precision measurement~\cite{robins_atom_2013, cronin_optics_2009}, quantum computation~\cite{ladd_quantum_2010, negretti_quantum_2011} and quantum simulation~\cite{bloch_quantum_2012, blatt_quantum_2012}.

Various experimental techniques are used to produce and study Bose--Einstein condensates, many of which exploit or necessitate an understanding of the quantum behaviour of the atomic systems in question. I summarise some of these techniques and detail the atomic physics principles underlying them in Chapter~\ref{chap:atomic_physics}.

The fields of Bose--Einstein condensation and cold atoms more generally enjoy a tight coupling between theory and experiment, not least because of the enduring usefulness and accuracy of mean-field theory. In mean-field theory, the quantum matter field operator of the atoms comprising a Bose--Einstein condensate is replaced with its expectation value at each point in space, allowing the entire multi-particle system to be modelled with little more computational complexity than that required to model a single-particle wavefunction.\footnote{Mean-field theory is accurate in the low-temperature limit, in which it has some remaining limitations---it does not for example predict the observed $s$-wave scattering halos when two \textsc{bec} wavepackets collide~\cite{norrie_quantum_2006}, but it is sufficient for modelling a  wide range of experiments nonetheless.} The resulting differential equation---the Gross--Pitaevskii equation---is nonlinear and using it to propagate a condensate wavefunction in time generally requires numerical techniques rather than analytic ones.

Chapter~\ref{chap:numerics} is a pedagogical presentation of how time-dependent quantum mechanics is simulated on a computer. I lay out the path one takes from differential equations containing abstract quantum-mechanical kets, to concrete arrays of numbers appropriate for a computer to perform calculations on. I give a detailed quantitative appraisal of a range of different techniques, their uses in cold atom physics and Bose--Einstein condensation, and compare their relative efficacies. I present arguments that a fairly sophisticated method of discretising partial differential equations---the finite-element discrete-variable representation---may offer less computational efficiency than simpler methods for computing solutions of comparable accuracy to the Gross--Pitaevskii and Schr\"odinger wave equations. I also develop a variation on fourth-order Runge--Kutta integration that improves on one of its deficiencies for simulating quantum systems. 
% As an experimental field, \textsc{bec} research involves the construction of apparatuses capable of implementing the techniques described in Chapter~\ref{chap:atomic_physics} in order to produce, control, and measure \textsc{bec}s. Chapter~\ref{chap:experiment} describes some of the process of constructing such an apparatus, which involves a vacuum system, magnetic coils and optical systems. I present an optical layout for producing magneto-optically trapped $^{87}$Rb atoms (a step on the way to condensation) that I designed and assembled as an exchange student in the group of József Fortágh at the University of T\"ubingen's Physikalisches Institut.

Production, control, and measurement of cold atom systems require more than the necessary optics and magnetic sources to be installed---these devices must be controllable in a time-accurate way in order to execute the necessary cooling processes, manipulate the system as desired, and observe the results. Production of a condensate takes on the order of tens of seconds, requiring precisely-timed pulses of laser light at specific frequencies, sweeps of magnetic field strengths, and frequency sweeps of radio and microwave radiation. This cannot all be done by human experimenters alone, and so requires computer automation of some kind. In Chapter~\ref{chap:software} I a discuss a suite of software programs, the \emph{labscript suite}, designed and developed by myself and others in the Monash Quantum Fluids group. The suite leverages modern software development techniques such as object orientation, abstraction and isolation, as well as older principles---such as aspects of the Unix philosophy---to produce a powerful, maintainable, extensible system for designing, running and analysing shot-based experiments on commodity hardware. This chapter also reproduces our publication on the labscript suite, \emph{A scripted control system for autonomous hardware-timed experiments}~\cite{starkey_scripted_2013}.

As superfluids, \bec s have zero viscosity and as such can support persistent flows. In classical fluid dynamics the absence of viscosity means that a fluid cannot support vorticity,\footnote{This is because the motion of vorticity is described by a diffusion equation---with viscosity as the diffusion constant. When the diffusion constant is zero, there is no way for vorticity to enter the fluid from a boundary in the first place!} and must be irrotational. However, fluid circulation can still occur around points of zero fluid density, known as vortices. In \bec s this circulation is also quantised, in units of $h/m$.

These quantised vortices are topological defects---the phase of the macroscopic wavefunction winds by a multiple of $2\pi$ around them, and is undefined at the centre of the vortex core itself.  Quantised vortices were observed in superfluid helium\footnote{In which 10\% or so of the atoms undergo Bose--Einstein condensation.} in the early 1960s~\cite{vinen_detection_1961}, and in \bec\ in a dilute atomic gas in 1999~\cite{matthews_vortices_1999}. The formation, dynamics and decay of these vortices are believed to be important for the study of superfluid turbulence~\cite{barenghi_quantized_2001}.

In Chapter~\ref{chap:velocimetry} I present simulations exploring the feasibility of imaging these vortices in-situ using \emph{tracer particles}. Atoms of one kind ($^{87}$Rb) may become trapped in the cores of quantised vortices in a condensate of another kind ($^{41}$K), and if imaged in a time-resolved way, reveal the motion of these vortices. A primary concern in any implementation of such a scheme is keeping the tracer atoms cold enough that they remain trapped in the vortex cores even as they scatter light for imaging. To that end, in Chapter~\ref{chap:velocimetry} I present modelling of imaging tracer atoms in a \textsc{bec} while they are cooled sympathetically via collisions with condensed atoms. I also present a novel---if impractical---laser cooling scheme for Sisyphus cooling of $^{87}$Rb atoms in a $34\unit{G}$ magnetic field---a field strength at which $^{87}$Rb and $^{41}$K repel each other strongly (leading to tighter trapping in the vortex cores).

% In a \textsc{bec}, the wavelike behaviour of matter is apparent, unlike at higher temperatures at which atoms are well described as classical particles. Not only are atoms in a \textsc{bec} wavelike, they are described by a \emph{nonlinear} wave equation. As with nonlinear optical systems, they therefore exhibit wave-mixing behaviour whereby a number of momentum states may interact to produce additional momentum states. In Chapter~\ref{chap:wave_mixing} I describe our lab's four wave mixing experiment, which reproduced an existing result for \textsc{bec}s, and then our attempt at six wave mixing---a higher order effect (in the sense of perturbation theory). We did not observe the expected six wave mixing, rather we saw \emph{four} wave mixing despite the required resonance condition apparently being violated. This result agreed with mean-field theory  simulations however, implying that the result was unlikely to be due to some experimental error.

% Atoms have spin, and when other spin-projection states cannot be disregarded, mean-field theory for spinful \textsc{bec}s takes the form of multiple, interacting fields. This allows for richer nonlinear dynamics that a single-component \textsc{bec}, with wave mixing producing new momentum states and new spin-projection states in tandem. In Chapter~\ref{chap:wave_mixing} I present simulation results showing this ``spin wave" mixing, although the main result is that---for $^{87}$Rb at least---the effect is very small and unlikely to be experimentally observable in existing $^{87}$Rb \textsc{bec} experiments.

At high temperatures (higher than that at which atoms Bose-condense) atoms are well described as classical particles. This is true in the sense that the wavelike nature of the atoms can be disregarded---they move through space like classical billiard balls obeying Newtonian mechanics. The internal state of the atoms, however---for example the state of an outer shell electron---may not be well modelled by classical mechanics. Even at room temperature, an electron is poorly described as a classical charged particle orbiting a nucleus. When there is \emph{coupling} then, between this internal state of an atom and its motional state, the quantum-ness of the internal state can in some sense `leak' into its motional state even if the motion is otherwise modelled well classically. The classic example of this is the Stern--Gerlach experiment~\cite{gerlach_experimentelle_1922}, in which a beam of atoms splits into two beams as it passes through a magnetic field gradient. A similar situation arises for atoms in a magnetic trap---a common feature of cold atom experiments and often used in the final stage of cooling to \textsc{bec}. To correctly model the losses of atoms from these traps, one needs to model the internal state of the atoms quantum-mechanically, but it is computationally expensive to also model their spatial motion using full quantum wavefunctions. We would like a way to model the atoms' motion classically, but in such a way that it can reproduce Stern--Gerlach separation---with modelled atoms taking one or the other trajectory probabilistically, with the probabilities consistent with those of a fully quantum treatment. In Chapter~\ref{chap:hvsc} I present such a model, one that is based on a \emph{hidden variable} carried around with each atom being modelled, which selects one of the atom's internal eigenstates. The apparent definiteness of the hidden variable allows the spatial motion part of the modelling to treat the atoms' spin projection degree of freedom as if it were in a definite state, allowing the modelling to take a single, definite trajectory. The hidden variable itself is evolved using a stochastic hidden variable theory that ensures its probability of corresponding to any particular spin-projection state is consistent with with the underlying quantum evolution of the atom's internal degrees of freedom.

Further background and introductory material is presented in the separate chapters of this thesis.

\section{What's new in this thesis}

The following two results comprise the primary scientific contributions of this thesis:

The use of hidden variables in semiclassical models of atomic dynamics was motivated by simulating evaporative cooling in a quadrupole magnetic trap. During a collaboration with Drs Turner and Anderson and Chris Watkins on this topic, we had the sobering realisation that a bedrock experiment of quantum mechanics---the Stern Gerlach experiment---was not simulable with oft-used semiclassical methods, despite the motional degree of freedom being irrefutably classical. I developed the hidden variable semiclassical method independently; only during the preparation of this thesis did I discover that the core idea mirrors that of surface hopping in quantum chemistry~\cite{doi:10.1063/1.459170}. This positioned me to identify these `hopping algorithms' with hidden-variable theories~\cite{PhysRevA.71.032325}, and elucidate unique aspects of my implementation.

The design and implementation of the \emph{labscript suite}~\cite{starkey_scripted_2013} advances the state of the art of laboratory control and on-line data analysis by importing powerful principles and techniques from the field of software engineering for use in not only the laboratory control software, but the experiments themselves. The realisation that physics experiments conceptually map well to computer programs, with modularity, re-use, input parameters and return values allowed us to apply solutions typical in software development to manage the complexity of a scientific experiment without limiting the power of the control system to execute arbitrarily complex experiments. Driven by ideas advanced by Scott Owen and David Hall~\cite{owen_fast_2003} and discussion within the Monash Quantum Fluids group with Drs Turner and Anderson, fellow PhD students Philip Starkey, Shaun Johnstone, and others; I extended the idea of writing experiments as code to the powerful yet simple to learn Python programming language, ideal for a physics laboratory in which new students must learn to operate the experiment effectively. This `experiment compiler', called \texttt{labscript}, is the core of the software suite we now call the labscript suite, which has been developed over the course of my PhD by myself, Philip Starkey and others, and now includes a number of separate programs for for setting input parameters, executing the experiment on heterogeneous hardware, and running user-provided analysis routines on the results, among other things. The software has been adopted for use by a number of groups at leading institutions worldwide, and as an open-source project has attracted an increasing number of third-party contributions that enhance its functionality or resolve issues. This open-source model, with code not only being available to end users but with development occurring in the open on the internet has proved to be beneficial for the long-term sustainability of the project, which is now seven years old and receives continuous bugfixes and updates to ensure it continues to benefit the experimental physics community.

Less significant but nevertheless noteworthy original contributions of this thesis include:

Simulations of tracer particles of one atomic species trapped in vortices in a Bose--Einstein condensate of another species, to asses the viability of the use of tracer particles in a non-destructive vortex imaging scheme. 

Numerical results of a new Sisyphus-like laser cooling scheme able to cool to sub-Doppler temperatures in a $34\unit{G}$ magnetic field, of interest due to a Feshbach resonance between $^{87}$Rb and $^{41}$K at this field strength.

A modification to the fourth-order Runge--Kutta method for time evolving differential equations in the presence of large energy differences, in addition to original analyses and appraisals of existing numerical methods contrasting their relative merits in the context of Bose--Einstein condensation quantum mechanics more generally.
